<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0  maximum-scale=1, user-scalable=no"
    />
    <link rel="icon" type="image/png" href="lightdark.png" alt="Favicon" />
    <!-- Favicon für Browser -->
    <meta
      name="keywords"
      content="programmieren lernen, kostenlos programmieren lernen, interaktiv programmieren, python lernen anfänger, javascript lernen, coding lernen deutsch, programmieren lernen online, coding challenges"
    />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://www.lern-coding.de/" />
    <link rel="icon" type="image/png" href="lightdark.png" alt="Favicon" />
    <link
      href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />

    <meta
      name="description"
      content="Lerne Programmieren interaktiv und praxisnah! Entdecke Tutorials, Coding-Challenges und Projekte für Anfänger und Fortgeschrittene auf von überall."
    />

    <!-- Apple Touch Icons für Home-Bildschirm -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="lightdark.png"
      alt="Favicon"
    />

    <!-- Optional: Theme-Farbe für Statusleiste -->
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Code-Match - LernCoding</title>
    <style>
      :root {
        --bg: #0b0f19;
        --surface: #111827;
        --text: #e2e8f0;
        --text-muted: #94a3b8;
        --accent: #6366f1;
        --accent-hover: #818cf8;
        --success: #22c55e;
        --error: #ef4444;
        --border: #334155;
        --glass: rgba(30, 41, 59, 0.5);
        --disabled: #4b5563;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Segoe UI", system-ui, sans-serif;
        background: var(--bg);
        color: var(--text);
        min-height: 100vh;
        padding: 1.5rem 1rem;
        line-height: 1.5;
      }

      .share-toast {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #111827;
        color: white;
        padding: 12px 20px;
        border-radius: 10px;
        border: 1px solid #6366f1;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        z-index: 9999;
        animation: fadeInOut 2.5s ease forwards;
      }

      @keyframes fadeInOut {
        0% {
          opacity: 0;
          transform: translate(-50%, 10px);
        }
        15% {
          opacity: 1;
          transform: translate(-50%, 0);
        }
        85% {
          opacity: 1;
        }
        100% {
          opacity: 0;
          transform: translate(-50%, 10px);
        }
      }

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2.5rem;
        flex-wrap: wrap;
        gap: 1rem;
        padding: 2rem;
        background: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.15),
          rgba(129, 140, 248, 0.1)
        );
        border: 1px solid var(--border);
        border-radius: 1.25rem;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        position: relative;
        overflow: hidden;
      }
      h1 {
        font-size: clamp(1.8rem, 5vw, 2.5rem);
        font-weight: 600;
        color: white;
        background: linear-gradient(135deg, #818cf8, #a78bfa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        position: relative;
        z-index: 1;
      }
      .back-btn {
        background: linear-gradient(135deg, var(--accent), var(--accent-hover));
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 0.75rem 1.5rem;
        border-radius: 0.75rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        z-index: 1;
        box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
      }
      .back-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(99, 102, 241, 0.6);
        border-color: rgba(255, 255, 255, 0.4);
      }
      .progress-container {
        width: 100%;
        max-width: 720px;
        height: 10px;
        background: var(--surface);
        border-radius: 999px;
        overflow: hidden;
        margin: 0 auto 1.5rem;
        border: 1px solid var(--border);
      }
      .progress-bar {
        height: 100%;
        width: 0;
        background: linear-gradient(90deg, var(--accent), var(--accent-hover));
        transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .stats {
        text-align: center;
        font-size: 1.15rem;
        margin-bottom: 2rem;
        color: var(--text-muted);
      }
      .stats strong {
        color: white;
        font-weight: 600;
      }
      .instruction {
        text-align: center;
        color: var(--text-muted);
        margin-bottom: 2rem;
        font-size: 1.1rem;
      }
      .targets {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1.25rem;
        max-width: 1200px;
        margin: 0 auto 3rem;
      }
      .dropzone {
        background: var(--glass);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border);
        border-radius: 1rem;
        padding: 1.25rem 1rem;
        min-height: 110px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        font-size: 1.1rem;
        font-weight: 500;
        color: var(--text);
        transition: all 0.25s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }
      .dropzone.over {
        border-color: var(--accent);
        background: rgba(99, 102, 241, 0.12);
        transform: translateY(-3px);
      }
      .correct {
        background: rgba(34, 197, 94, 0.2) !important;
        border-color: var(--success) !important;
        color: white !important;
      }
      .wrong {
        border-color: var(--error) !important;
        background: rgba(239, 68, 68, 0.15) !important;
        animation: shake 0.4s ease;
      }
      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-6px);
        }
        75% {
          transform: translateX(6px);
        }
      }
      .words {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        justify-content: center;
        max-width: 1200px;
        margin: 0 auto;
        padding: 1.5rem;
        background: var(--surface);
        border-radius: 1rem;
        border: 1px dashed var(--border);
      }
      .word {
        background: var(--accent);
        color: white;
        padding: 0.9rem 1.6rem;
        border-radius: 0.75rem;
        font-size: 1.15rem;
        font-weight: 500;
        cursor: grab;
        user-select: none;
        transition: all 0.2s ease;
        box-shadow: 0 3px 10px rgba(99, 102, 241, 0.3);
      }
      .word:active {
        cursor: grabbing;
        transform: scale(1.06) translateY(-2px);
      }
      .word.disabled {
        background: var(--disabled);
        opacity: 0.55;
        cursor: not-allowed;
        box-shadow: none;
        pointer-events: none;
      }
      .hint-button,
      .share-button {
        display: inline-block;
        margin: 1.5rem 0.5rem;
        padding: 0.75rem 1.75rem;
        border: none;
        border-radius: 0.75rem;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }
      .hint-button {
        background: linear-gradient(135deg, #a78bfa, #c084fc);
        color: white;
      }
      .hint-button:hover:not(:disabled) {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(167, 139, 250, 0.6);
      }
      .hint-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      .share-button {
        background: linear-gradient(135deg, #6b7280, #9ca3af);
        color: white;
        box-shadow: 0 4px 15px rgba(107, 114, 128, 0.4);
      }
      .share-button:hover:not(:disabled) {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(107, 114, 128, 0.6);
      }
      .fairy {
        position: fixed;
        font-size: 3rem;
        pointer-events: none;
        z-index: 999;
      }
      @keyframes fairyFly {
        0% {
          opacity: 1;
          transform: translate(0, 0) scale(1);
        }
        50% {
          opacity: 1;
        }
        100% {
          opacity: 0;
          transform: translate(var(--tx), var(--ty)) scale(0.3);
        }
      }
      .fairy.flying {
        animation: fairyFly 2s ease-in-out forwards;
      }
      .sparkle {
        position: fixed;
        font-size: 1.5rem;
        pointer-events: none;
        z-index: 998;
      }
      @keyframes sparkleFloat {
        0% {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
        100% {
          opacity: 0;
          transform: translateY(-40px) scale(0);
        }
      }
      .sparkle.animate {
        animation: sparkleFloat 1.5s ease-out forwards;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>LernCoding Game</h1>
      <button
        class="back-btn"
        onclick="window.location.href = 'https://lern-coding.de'"
      >
        ← Zurück zu lern-coding.de
      </button>
    </header>

    <div class="progress-container">
      <div id="progress-bar" class="progress-bar"></div>
    </div>

    <div class="stats">
      Level <strong id="level">1</strong> • Punkte:
      <strong id="points">0</strong>
    </div>

    <p class="instruction">
      Ziehe die Programmiersprache zum passenden Begriff
    </p>

    <div style="text-align: center; margin: 1.5rem 0">
      <button class="hint-button" id="hintBtn" onclick="showHint()">
        Hinweis
      </button>
      <button class="share-button" id="shareBtn">Teilen</button>
    </div>

    <div class="targets" id="targets"></div>
    <div class="words" id="words"></div>

    <p
      style="
        text-align: center;
        color: var(--text-muted);
        margin-top: 2rem;
        font-size: 0.95rem;
      "
    >
      Halte die Begriffe gedrückt und ziehe sie zu den passenden Sprachen
    </p>

    <script>
      const vocabulary = [
        // HTML (wie zuvor – unverändert)
        { de: "DOCTYPE", lang: "html" },
        { de: "<div>", lang: "html" },
        { de: "alt-Attribut", lang: "html" },
        { de: '<meta charset="UTF-8">', lang: "html" },
        { de: "<head>", lang: "html" },
        { de: "<body>", lang: "html" },
        { de: "<title>", lang: "html" },
        { de: "<h1> bis <h6>", lang: "html" },
        { de: "<p>", lang: "html" },
        { de: "<a href>", lang: "html" },
        { de: "<img src>", lang: "html" },
        { de: "<br>", lang: "html" },
        { de: "<form>", lang: "html" },
        { de: "<input>", lang: "html" },
        { de: "<button>", lang: "html" },
        { de: "<ul> / <li>", lang: "html" },
        { de: "<ol>", lang: "html" },
        { de: "<table>", lang: "html" },
        { de: "<header>", lang: "html" },
        { de: "<footer>", lang: "html" },
        { de: "<section>", lang: "html" },
        { de: "<article>", lang: "html" },
        { de: "<nav>", lang: "html" },
        { de: "<aside>", lang: "html" },
        { de: "<strong>", lang: "html" },
        { de: "<em>", lang: "html" },
        { de: "<span>", lang: "html" },
        { de: "<iframe>", lang: "html" },
        { de: "class-Attribut", lang: "html" },
        { de: "id-Attribut", lang: "html" },
        // CSS (wie zuvor)
        { de: "display: flex", lang: "css" },
        { de: "border-radius", lang: "css" },
        { de: ":hover", lang: "css" },
        { de: "background: linear-gradient", lang: "css" },
        { de: "box-shadow", lang: "css" },
        { de: "padding", lang: "css" },
        { de: "margin", lang: "css" },
        { de: "width / height", lang: "css" },
        { de: "color", lang: "css" },
        { de: "background-color", lang: "css" },
        { de: "font-size", lang: "css" },
        { de: "text-align", lang: "css" },
        { de: "position: absolute", lang: "css" },
        { de: "position: relative", lang: "css" },
        { de: "z-index", lang: "css" },
        { de: "opacity", lang: "css" },
        { de: "transform: rotate()", lang: "css" },
        { de: "transition", lang: "css" },
        { de: "animation", lang: "css" },
        { de: "@media queries", lang: "css" },
        { de: "display: grid", lang: "css" },
        { de: "gap", lang: "css" },
        { de: "flex-direction", lang: "css" },
        { de: "justify-content", lang: "css" },
        { de: "align-items", lang: "css" },
        { de: "border", lang: "css" },
        { de: "box-sizing: border-box", lang: "css" },
        { de: "overflow: hidden", lang: "css" },
        { de: "cursor: pointer", lang: "css" },
        // JS + Python (wie zuvor – gekürzt dargestellt, aber komplett drin lassen)
        // ... (restliche Einträge unverändert)
      ];

      let currentRound = [];
      let points = 0;
      let level = 1;
      let xp = 0;
      const xpPerLevel = 100;

      const levelEl = document.getElementById("level");
      const pointsEl = document.getElementById("points");
      const progressBar = document.getElementById("progress-bar");
      const hintBtn = document.getElementById("hintBtn");
      const shareBtn = document.getElementById("shareBtn");

      let hintsUsed = 0;
      const maxHintsPerRound = 1;

      function showHint() {
        if (hintsUsed >= maxHintsPerRound) {
          hintBtn.disabled = true;
          hintBtn.textContent = "Hinweis bereits verwendet";
          return;
        }
        hintsUsed++;
        hintBtn.disabled = true;

        const targets = document.querySelectorAll(".dropzone");
        let targetToHint = null;
        let wordToHint = null;

        for (let target of targets) {
          if (!target.classList.contains("correct")) {
            const requiredLang = target.dataset.correct;
            const words = document.querySelectorAll(".word");
            for (let word of words) {
              if (
                word.dataset.value === requiredLang &&
                !word.classList.contains("disabled")
              ) {
                targetToHint = target;
                wordToHint = word;
                break;
              }
            }
            if (wordToHint) break;
          }
        }

        if (targetToHint && wordToHint) {
          animateFairyHint(wordToHint, targetToHint);
        }
      }

      function animateFairyHint(fromElem, toElem) {
        const fromRect = fromElem.getBoundingClientRect();
        const toRect = toElem.getBoundingClientRect();

        const fairy = document.createElement("div");
        fairy.className = "fairy";
        fairy.textContent = "→";
        fairy.style.left = fromRect.left + fromRect.width / 2 + "px";
        fairy.style.top = fromRect.top + fromRect.height / 2 + "px";
        document.body.appendChild(fairy);

        const deltaX =
          toRect.left + toRect.width / 2 - (fromRect.left + fromRect.width / 2);
        const deltaY =
          toRect.top + toRect.height / 2 - (fromRect.top + fromRect.height / 2);

        fairy.style.setProperty("--tx", deltaX + "px");
        fairy.style.setProperty("--ty", deltaY + "px");

        setTimeout(() => fairy.classList.add("flying"), 10);

        setTimeout(() => {
          fairy.remove();
          toElem.style.outline = "none";
        }, 2000);
      }

      shareBtn.addEventListener("click", async () => {
        const shareText = `Code-Match – mein aktueller Stand

      Level: ${level}
      Punkte: ${points}
      XP: ${xp} / ${xpPerLevel}

      Spiel mit:
      https://lern-coding.de`;

        // 1. Web Share API (Mobile, moderne Browser)
        if (navigator.share) {
          try {
            await navigator.share({
              title: "LernCoding – mein Spielstand",
              text: shareText,
            });
            return;
          } catch (err) {
            // User hat abgebrochen → nichts tun
          }
        }

        // 2. Clipboard Fallback (Desktop, alle Browser)
        try {
          await navigator.clipboard.writeText(shareText);
          showShareToast("Spielstand kopiert! Jetzt überall einfügen");
        } catch {
          // 3. Letzter Fallback (Prompt)
          window.prompt("Kopiere deinen Spielstand:", shareText);
        }

        function fallbackCopy() {
          navigator.clipboard
            .writeText(shareText)
            .then(() => {
              alert("Ergebnis in die Zwischenablage kopiert:\n\n" + shareText);
            })
            .catch(() => {
              alert(
                "Kopieren nicht möglich. Hier der Text zum manuellen Kopieren:\n\n" +
                  shareText,
              );
            });
        }
      });

      function saveProgress() {
        localStorage.setItem(
          "codeMatchProgress",
          JSON.stringify({ points, level, xp }),
        );
      }

      function loadProgress() {
        const data = localStorage.getItem("codeMatchProgress");
        if (data) {
          const saved = JSON.parse(data);
          points = saved.points ?? 0;
          level = saved.level ?? 1;
          xp = saved.xp ?? 0;
        }
      }

      function updateUI() {
        pointsEl.textContent = points;
        levelEl.textContent = level;

        while (xp >= xpPerLevel) {
          xp -= xpPerLevel;
          level++;
        }

        progressBar.style.width = Math.min((xp / xpPerLevel) * 100, 100) + "%";
        saveProgress();
      }

      function startNewRound() {
        hintsUsed = 0;
        hintBtn.disabled = false;
        hintBtn.textContent = "Hinweis";

        let shuffled = [...vocabulary].sort(() => Math.random() - 0.5);
        currentRound = shuffled.slice(0, 4);

        const targetsDiv = document.getElementById("targets");
        const wordsDiv = document.getElementById("words");
        targetsDiv.innerHTML = "";
        wordsDiv.innerHTML = "";

        currentRound.forEach((item) => {
          const zone = document.createElement("div");
          zone.className = "dropzone";
          zone.textContent = item.de;
          zone.dataset.correct = item.lang;

          zone.addEventListener("dragover", (e) => {
            e.preventDefault();
            zone.classList.add("over");
          });
          zone.addEventListener("dragleave", () =>
            zone.classList.remove("over"),
          );

          zone.addEventListener("drop", (e) => {
            e.preventDefault();
            zone.classList.remove("over");

            const droppedLang = e.dataTransfer.getData("lang");
            const draggedId = e.dataTransfer.getData("id");

            if (droppedLang === zone.dataset.correct) {
              zone.classList.add("correct");
              zone.textContent += ` ✓ ${droppedLang.toUpperCase()}`;
              points += 25;
              xp += 25;
              updateUI();

              const draggedWord = document.getElementById(draggedId);
              if (draggedWord) {
                draggedWord.classList.add("disabled");
                draggedWord.draggable = false;
              }

              if (
                document.querySelectorAll(".correct").length ===
                currentRound.length
              ) {
                setTimeout(startNewRound, 1500);
              }
            } else {
              zone.classList.add("wrong");
              setTimeout(() => zone.classList.remove("wrong"), 1000);
            }
          });

          targetsDiv.appendChild(zone);
        });

        const langs = currentRound
          .map((item) => item.lang)
          .sort(() => Math.random() - 0.5);
        langs.forEach((lang) => {
          const wordElem = document.createElement("div");
          const wordId = "word-" + Math.random().toString(36).slice(2);
          wordElem.className = "word";
          wordElem.id = wordId;
          wordElem.draggable = true;
          wordElem.textContent = lang.toUpperCase();
          wordElem.dataset.value = lang;

          wordElem.addEventListener("dragstart", (e) => {
            if (wordElem.classList.contains("disabled")) {
              e.preventDefault();
            } else {
              e.dataTransfer.setData("lang", lang);
              e.dataTransfer.setData("id", wordId);
            }
          });

          wordsDiv.appendChild(wordElem);
        });
      }

      loadProgress();
      updateUI();
      startNewRound();
    </script>
  </body>
</html>
